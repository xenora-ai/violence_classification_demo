# Violence Detection AI (MVP)

Прототип інтелектуальної системи для автоматизованого виявлення та класифікації насильницьких дій у відеопотоці в режимі, наближеному до реального часу.

## Огляд проєкту

Дана робота реалізує мінімально працюючу версію системи (MVP) для бінарної класифікації відеоданих на класи «насильство» та «норма». Основна увага приділена перевірці ефективності просторово-часового аналізу відео порівняно з пофрагментним підходом.

## Технічна архітектура

Система базується на архітектурі **CNN-LSTM**:

* **Backbone (CNN):** Використано модель MobileNetV2 для виділення просторових ознак із окремих кадрів.


* **Temporal Model (LSTM):** Рекурентна частина забезпечує врахування часових залежностей та моделювання динаміки подій у відеопослідовності.


* **Обробка даних:** Реалізовано асинхронний конвеєр обробки, де захоплення відео та інференс нейромережі рознесені у різні потоки для стабільної роботи на CPU.

## Ключові особливості реалізації

* **Механізм буферизації:** Використання кільцевого буфера (Ring Buffer) на 75 кадрів забезпечує системі часовий контекст тривалістю близько 3 секунд.
* **Адаптивний семплінг:** Алгоритм підготовки даних дозволяє вибирати 16 або 32 кадри з вікна спостереження для балансування між швидкістю та точністю класифікації.
* **Асинхронність:** Розділення процесів візуалізації та обчислень дозволяє уникнути затримок інтерфейсу під час роботи нейромережі.
* **Інструменти аналітики:** Візуалізація результатів у реальному часі з відображенням імовірності, статусу події та часу інференсу.



## Стек технологій

* **Мова програмування:** Python.
* **Глибоке навчання:** PyTorch, Torchvision.


* **Комп'ютерний зір:** OpenCV.
* **Веб-інтерфейс:** Streamlit.
* **Математичні обчислення:** NumPy.

## Інструкція із запуску

1. **Встановлення необхідних бібліотек:**
```bash
pip install torch torchvision opencv-python streamlit numpy
```


2. **Запуск графічного інтерфейсу (Streamlit):**
```bash
streamlit run app.py
```


3. **Запуск консольного прототипу для тестування:**
```bash
python demo_mvp.py
```



## Структура репозиторію
* `app.py` — реалізація інтерфейсу користувача та логіки взаємодії.
* `demo_mvp.py` — асинхронний скрипт для тестування відеопотоку.
* `src/model.py` — опис архітектури CNN-LSTM.


* `src/utils.py` — допоміжні функції для препроцесингу та малювання HUD.
* `weights/` — папка для збереження ваг навчених моделей.

---
